<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日志记录</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link rel="shortcut icon" href="favicon.ico"> <link href="../static/admin/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../static/admin/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../static/admin/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="../static/admin/css/animate.css" rel="stylesheet">
    <link href="../static/admin/css/style.css?v=4.1.0" rel="stylesheet">

</head>

<body class="gray-bg">
	
	<div class="row">
	    <div class="col-sm-12">
	        <div class="tabs-container">
	            <ul class="nav nav-tabs">
	                <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true" onclick="logger(1)"> 系统日志</a>
	                </li>
	                <li class=""><a data-toggle="tab" href="#tab-1" aria-expanded="false" onclick="logger(0)">用户日志</a>
	                </li>
	            </ul>
	            <div class="tab-content">
	                <div id="tab-1" class="tab-pane active">
	                    <div class="panel-body">
	                    <div class="row">
						    <div class="col-sm-12">
						        <div class="ibox float-e-margins">
						            
						            <div class="ibox-content">
						                <table class="table" ID= "adminLog">
						                </table>
						            </div>
						        </div>
						    </div>
						</div>
						</div>
	                </div>
	            </div>
	
	
	        </div>
	    </div>
	</div>	

		
    <!-- 全局js -->
	<script src="../static/admin/js/jquery.min.js?v=2.1.4"></script>
    <script src="../static/admin/js/jquery.min.js?v=2.1.4"></script>
    <script src="../static/admin/js/bootstrap.min.js?v=3.3.6"></script>
	<script src="../static/admin/js/jquery.form.js"></script>
	<script src="../static/admin/js/jquery.cookie.js"></script>
	<script src="../static/admin/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
	<script src="../static/admin/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
	<script src="../static/admin/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>

    <script type="application/javascript">
		$.ajaxSetup({
			headers: {
				'Authorization': $.cookie("token")
			},
			xhrFields: {
				withCredentials: false
			},
			crossDomain: true
		});
		
		$(function() {
			if ($.cookie("token") == null || $.cookie("token") == "") {
				window.location.href = "/admin/login.html"
			}
		});
		
		
		$(function(){logger(1)})
		function logClick(num){
			logger(num);
			$('#adminLog').bootstrapTable('refresh');
		}
		function logger(type) {
			$('#adminLog').bootstrapTable('destroy'); 
			$('#adminLog').bootstrapTable({
				method: 'get',
				url: "http://test.wslhome.top/admin/getAllLoggerByType/v1",
				dataType: "json",
				headers: {
					'Authorization': $.cookie("token")
				},
				ajaxOptions: {
				    xhrFields: {
				        withCredentials: false
				    },
				    crossDomain: true
				},
				striped: true,
				pageNumber: 1,
				pagination: true,
				sidePagination: 'server',
				pageSize: 15,
				pageList: [5, 10, 15,20, 30,50],
				showRefresh: false,
				silent: true, 
				cache: false,
				queryParams: queryParams,
				responseHandler: returnFormat,
				columns: [{
					title: 'Id',
					field: 'id',
					sortable: true
				}, {
					title: '操作细节',
					field: 'detail',
					sortable: true
				}, {
					title: '操作人姓名',
					field: 'name',
					sortable: true
				}, {
					title: '操作人Id',
					field: 'manId',
					sortable: true
				}, {
					title: 'IP地址',
					field: 'ip',
					sortable: true
				} , {
					title: '操作时间',
					field: 'creatTime',
					sortable: true
				}, {
					title: '操作等级',
					field: 'grade',
					formatter: function(value, row, index) {
						var html = "";
						if (row.grade == 1){
							html = '<t style="color:green">正常</t>';
						}else if(row.grade == 2){
							html = '<t style="color:blue">一般</t>';
						}else if(row.grade == 3){
							html = '<t style="color:pink">严重</t>';
						}else if(row.grade == 4){
							html = '<t style="color:red">非常严重</t>';
						}
						return html;
					}
				}]
			})
			function queryParams(params) {
				var temp = {
					page : (params.offset / params.limit) + 1,
					num: params.limit,
					type: type					
				};
				return temp;
			}
		
			function returnFormat(res) {
				return {
					"rows":res.data.records,
					"total": res.data.total
				};
			}
		}
	</script>
    

</body>

</html>
